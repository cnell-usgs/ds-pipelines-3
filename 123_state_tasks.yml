# Do not edit - automatically generated
# from the task_makefile.mustache template
# by create_task_makefile() via do_state_tasks()
# using scipiper package version 0.0.19

target_default: 123_state_tasks

include:
  - remake.yml

packages:
  - tidyverse
  - dataRetrieval
  - lubridate

sources:
  - 1_fetch/src/get_site_data.R
  - 3_visualize/src/plot_site_data.R
  - 2_process/src/tally_site_obs.R

file_extensions:
  - "ind"

targets:
  123_state_tasks:
    depends:
      - obs_tallies_promise
      - timeseries_plots.yml_promise

  # --- WI --- #
  
  WI_data:
    command: get_site_data('1_fetch/tmp/inventory_WI.tsv', parameter)

  3_visualize/out/timeseries_WI.png:
    command: plot_site_data(out_file = target_name, site_data = WI_data, parameter = parameter)

  WI_tally:
    command: tally_site_obs(site_data = WI_data)

  # --- MN --- #
  
  MN_data:
    command: get_site_data('1_fetch/tmp/inventory_MN.tsv', parameter)

  3_visualize/out/timeseries_MN.png:
    command: plot_site_data(out_file = target_name, site_data = MN_data, parameter = parameter)

  MN_tally:
    command: tally_site_obs(site_data = MN_data)

  # --- MI --- #
  
  MI_data:
    command: get_site_data('1_fetch/tmp/inventory_MI.tsv', parameter)

  3_visualize/out/timeseries_MI.png:
    command: plot_site_data(out_file = target_name, site_data = MI_data, parameter = parameter)

  MI_tally:
    command: tally_site_obs(site_data = MI_data)

  # --- IL --- #
  
  IL_data:
    command: get_site_data('1_fetch/tmp/inventory_IL.tsv', parameter)

  3_visualize/out/timeseries_IL.png:
    command: plot_site_data(out_file = target_name, site_data = IL_data, parameter = parameter)

  IL_tally:
    command: tally_site_obs(site_data = IL_data)

  # --- IN --- #
  
  IN_data:
    command: get_site_data('1_fetch/tmp/inventory_IN.tsv', parameter)

  3_visualize/out/timeseries_IN.png:
    command: plot_site_data(out_file = target_name, site_data = IN_data, parameter = parameter)

  IN_tally:
    command: tally_site_obs(site_data = IN_data)

  # --- IA --- #
  
  IA_data:
    command: get_site_data('1_fetch/tmp/inventory_IA.tsv', parameter)

  3_visualize/out/timeseries_IA.png:
    command: plot_site_data(out_file = target_name, site_data = IA_data, parameter = parameter)

  IA_tally:
    command: tally_site_obs(site_data = IA_data)

  # --- CA --- #
  
  CA_data:
    command: get_site_data('1_fetch/tmp/inventory_CA.tsv', parameter)

  3_visualize/out/timeseries_CA.png:
    command: plot_site_data(out_file = target_name, site_data = CA_data, parameter = parameter)

  CA_tally:
    command: tally_site_obs(site_data = CA_data)

  # --- WA --- #
  
  WA_data:
    command: get_site_data('1_fetch/tmp/inventory_WA.tsv', parameter)

  3_visualize/out/timeseries_WA.png:
    command: plot_site_data(out_file = target_name, site_data = WA_data, parameter = parameter)

  WA_tally:
    command: tally_site_obs(site_data = WA_data)

  # --- Overall job --- #

  obs_tallies_promise:
    command: combine_obs_tallies(
      `WI_tally`,
      '3_visualize/out/timeseries_WI.png',
      `MN_tally`,
      '3_visualize/out/timeseries_MN.png',
      `MI_tally`,
      '3_visualize/out/timeseries_MI.png',
      `IL_tally`,
      '3_visualize/out/timeseries_IL.png',
      `IN_tally`,
      '3_visualize/out/timeseries_IN.png',
      `IA_tally`,
      '3_visualize/out/timeseries_IA.png',
      `CA_tally`,
      '3_visualize/out/timeseries_CA.png',
      `WA_tally`,
      '3_visualize/out/timeseries_WA.png')
    
  timeseries_plots.yml_promise:
    command: summarize_timeseries_plots(I('3_visualize/out/timeseries_plots.yml'),
      `WI_tally`,
      '3_visualize/out/timeseries_WI.png',
      `MN_tally`,
      '3_visualize/out/timeseries_MN.png',
      `MI_tally`,
      '3_visualize/out/timeseries_MI.png',
      `IL_tally`,
      '3_visualize/out/timeseries_IL.png',
      `IN_tally`,
      '3_visualize/out/timeseries_IN.png',
      `IA_tally`,
      '3_visualize/out/timeseries_IA.png',
      `CA_tally`,
      '3_visualize/out/timeseries_CA.png',
      `WA_tally`,
      '3_visualize/out/timeseries_WA.png')
    
